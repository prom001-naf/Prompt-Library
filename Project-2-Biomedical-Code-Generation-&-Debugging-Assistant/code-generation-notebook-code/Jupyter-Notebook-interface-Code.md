# Jupyter-Notebook-interface-Code

1.  **Introduction & Warning:** Explains the notebook's purpose and carries a strong security warning about executing AI-generated code.
2.  **Setup & Configuration:** Installs necessary libraries and configures API keys for OpenAI and NCBI (for PubMed).
3.  **The Core Engine:** Contains the Python function that:
    *   Takes a user's plain-language task.
    *   Engineers a detailed prompt for the OpenAI LLM.
    *   Sends the prompt to the API.
    *   Receives the generated Python code.
    *   **Displays the code for review.**
    *   **Executes the code** and captures its output.
    *   Displays the final result.
4.  **Interactive Interface:** Uses `ipywidgets` to provide a user-friendly text box and button to run tasks without needing to edit code.
5.  **Example Tasks:** Includes several pre-filled examples to demonstrate the notebook's capabilities, from simple literature searches to more complex gene data retrieval.

---

### Here is the content for your Jupyter Notebook.

You can copy and paste the content of each cell into a new Jupyter Notebook (`.ipynb`) file.

---

### Cell 1: Title and Introduction

```markdown
# AI-Powered Biomedical Task Automation Engine

This Jupyter Notebook uses the OpenAI API to translate plain-language biomedical tasks into executable Python code. It then runs this code to perform tasks like searching PubMed, fetching gene information, and analyzing biological data.

## ‚ö° How it Works
1.  **You Enter a Task:** Type a request like `"Find the 5 most recent papers on CRISPR for liver cancer"` into the text box.
2.  **AI Generates Code:** The notebook sends your request to an OpenAI model (like GPT-4), asking it to write a Python script to accomplish the task using libraries like `BioPython` and `pandas`.
3.  **Review and Execute:** The generated code is displayed for your review. The notebook then executes this code.
4.  **Get Results:** The output of the executed code (e.g., a list of papers, a data table) is displayed directly in the notebook.

## ‚ö†Ô∏è IMPORTANT SECURITY WARNING ‚ö†Ô∏è

This notebook uses Python's `exec()` function to run code generated by an AI. This is **extremely powerful** but also **potentially dangerous**.

*   **NEVER** run this notebook in an environment with sensitive data or access to critical systems.
*   **ALWAYS** review the generated code before execution to ensure it does what you expect and doesn't contain malicious commands (e.g., deleting files, accessing private information).
*   This tool is intended for **research and prototyping in a controlled environment** by users who understand the risks.

**By running the cells below, you acknowledge and accept these risks.**
```

### Cell 2: Setup and Dependencies

```python
# Install necessary libraries
!pip install openai biopython pandas ipywidgets requests --quiet

print("‚úÖ Libraries installed successfully.")
```

### Cell 3: API Key Configuration

```python
import os
import getpass
from openai import OpenAI
import pandas as pd
from Bio import Entrez
import io
import sys

# --- OpenAI API Key ---
# It's best practice to use environment variables or a key management service.
# For this notebook, we'll use getpass to avoid showing the key in the cell.
try:
    os.environ["OPENAI_API_KEY"] = getpass.getpass("Enter your OpenAI API Key: ")
    client = OpenAI()
    print("‚úÖ OpenAI API Key configured.")
except Exception as e:
    print(f"üî• Error setting up OpenAI client: {e}")
    print("Please make sure you have entered a valid API key.")


# --- NCBI Entrez Configuration ---
# NCBI requires an email address for API access to identify users.
# This helps them contact you if there's an issue with your queries.
NCBI_EMAIL = "your.email@example.com" # <--- IMPORTANT: REPLACE WITH YOUR REAL EMAIL
if NCBI_EMAIL == "your.email@example.com":
    print("‚ö†Ô∏è Please replace 'your.email@example.com' with your actual email address for NCBI Entrez.")
else:
    Entrez.email = NCBI_EMAIL
    print(f"‚úÖ NCBI Entrez email set to: {Entrez.email}")

# Set a higher display limit for pandas dataframes
pd.set_option('display.max_rows', 200)
pd.set_option('display.max_colwidth', 150)
```

### Cell 4: The Core AI and Execution Engine

```python
def create_and_run_biomedical_code(task: str, model: str = "gpt-4-turbo-preview"):
    """
    Takes a plain-language task, generates Python code via OpenAI,
    and executes it to produce a result.

    Args:
        task (str): The user's biomedical task in plain language.
        model (str): The OpenAI model to use for code generation.
    """
    print(f" MTask: '{task}'")
    print("="*50)
    print("üß† Step 1: Generating Python code with OpenAI...")

    # --- Prompt Engineering: Give the AI context and constraints ---
    system_prompt = """
    You are an expert bioinformatician and Python programmer. Your task is to write a single,
    executable Python script to solve a biomedical query.

    Constraints:
    - The script must be self-contained and use only the following pre-installed libraries:
      `Bio.Entrez` from `biopython`, `pandas`, `requests`, `io`, `sys`.
    - Use the `Entrez.email` variable which is already set in the global scope.
    - Your final output MUST be generated using the `print()` function. For example, print a pandas DataFrame or a formatted string.
    - Do not include any markdown formatting (like ```python), explanations, or comments outside of the code block.
    - The code will be executed using `exec()`. Ensure it is valid, complete, and produces a clear, printed output.
    """

    user_prompt = f"Here is the user's task: \"{task}\""

    try:
        response = client.chat.completions.create(
            model=model,
            messages=[
                {"role": "system", "content": system_prompt},
                {"role": "user", "content": user_prompt},
            ],
            temperature=0.1 # Lower temperature for more deterministic, code-focused output
        )
        generated_code = response.choices[0].message.content
    except Exception as e:
        print(f"üî• An error occurred with the OpenAI API call: {e}")
        return

    print("‚úÖ Code generated successfully.")
    print("\n" + "="*50)
    print("üêç Step 2: Generated Code (Review before execution!)")
    print("="*50)
    # Display the code for review
    print(generated_code)
    print("="*50 + "\n")


    # --- Code Execution with Output Capture ---
    print("üöÄ Step 3: Executing code...")
    print("="*50)
    # Create a string buffer to capture stdout
    old_stdout = sys.stdout
    redirected_output = io.StringIO()
    sys.stdout = redirected_output

    try:
        # Execute the code. Pass `globals()` to give it access to our configured variables
        # like `NCBI_EMAIL` and imported libraries like `pandas`.
        exec(generated_code, globals())
    except Exception as e:
        # If the code fails, print the error
        sys.stdout = old_stdout # Restore stdout
        print(f"üî• An error occurred during code execution: {e}")
        return

    # Restore stdout and get the captured output
    sys.stdout = old_stdout
    output = redirected_output.getvalue()

    print("‚úÖ Execution complete.")
    print("\n" + "="*50)
    print("üìä Step 4: Results")
    print("="*50)
    print(output)
```

### Cell 5: Interactive User Interface

```python
import ipywidgets as widgets
from IPython.display import display

# Create UI components
task_textarea = widgets.Textarea(
    value='Find the 10 most recent publications about "GLP-1 agonists" and display the title and PubMed ID.',
    placeholder='Enter your biomedical task here...',
    description='Task:',
    layout={'width': '90%', 'height': '100px'},
    disabled=False
)

run_button = widgets.Button(
    description='Generate & Run Code',
    button_style='success',
    tooltip='Click to send the task to the AI and run the resulting code',
    icon='cogs'
)

output_area = widgets.Output()

def on_button_clicked(b):
    with output_area:
        output_area.clear_output()
        if not task_textarea.value:
            print("Please enter a task in the text box.")
            return
        # The main function call
        create_and_run_biomedical_code(task_textarea.value)

run_button.on_click(on_button_clicked)

# Display the UI
print("Enter your task in the text area below and click the button.")
display(task_textarea, run_button, output_area)
```

### Cell 6: More Example Tasks (for inspiration)

```markdown
## üí° Example Tasks to Try

Here are some other tasks you can copy and paste into the text box above to see what this notebook can do.

---
### **Literature Search**
*Simple:*
`Find the 5 most recent review articles on Alzheimer's disease.`

*Advanced:*
`Search for clinical trials published in the last 2 years related to CAR-T therapy for pancreatic cancer. Display their titles and PMIDs.`

---
### **Gene Information**
*Simple:*
`Get the official gene summary for the human gene "TP53".`

*Intermediate:*
`Fetch the genomic location (chromosome and sequence position) for the human gene BRAF.`

---
### **Data Retrieval and Formatting**
*Simple:*
`Find the top 5 genes associated with Parkinson's disease from the 'gene' database and list their names and IDs.`

*Advanced (might require more complex code generation):*
`Fetch the protein sequences for human insulin (INS) and glucagon (GCG) in FASTA format.`
```